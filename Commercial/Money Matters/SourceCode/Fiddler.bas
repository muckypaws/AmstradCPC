1000 ' MELODY/BASS LINE Generator Created By Jason Brooks
1010 ' (C) 1992 JacesofT Software Ltd
1020 DIM left%(2,300),right%(2,300),middle%(3,300)
1030 DEF FNperiod%(note%)=ROUND(62500/(440*(2^(oct%+((note%-10)/12)))))
1040 tone$=" C C#D D#E F F#G G#A A#B R"
1045 ENV 1,1,15,1,3,-1,1,5,0,1,12,-1,5
1050 ' Sort Out Melody Line Data
1052 PRINT"Coding CHANNEL A:"
1055 pass=1:pointer%=1
1060 RESTORE 10000:oct%=0
1080 GOSUB 4000:'Decode note data
1090 IF note$="X" THEN 1120
1100 left%(1,pointer%)=note%:left%(2,pointer%)=dur%:pointer%=pointer%+1
1110 GOTO 1080
1120 pass=pass+1:IF pass=2 THEN 1080
1130 IF pass=3 THEN 1060
1140 IF PASS=4 THEN RESTORE 10110:GOTO 1080
1150 fa=pointer%
1200 ' Sort out BASS line (Right) channel music data.
1205 PRINT"Coding CHANNEL B:"
1210 pass=1:point%=1
1220 RESTORE 11000:oct%=-1
1230 GOSUB 4000
1240 IF note$="X" THEN 1270
1250 right%(1,point%)=note%:right%(2,point%)=dur%:point%=point%+1
1260 GOTO 1230
1270 pass=pass+1:IF pass=2 THEN 1230
1280 IF pass=3 THEN 1220
1290 IF pass=4 THEN RESTORE 11170:GOTO 1230
1300 fc=point%
1500 ' Sort out Melody/Bass Line (Middle) channel music data.
1510 PRINT"Coding CHANNEL C:":pass=1:point%=1
1520 RESTORE 12000
1530 GOSUB 4000
1540 IF note$="X" THEN 1570
1550 middle%(1,point%)=note%:middle%(2,point%)=dur%:point%=point%+1
1560 GOTO 1530
1570 pass=pass+1:IF pass=2 THEN 1530
1580 IF pass=3 THEN 1520
1590 IF pass=4 THEN RESTORE 12160:GOTO 1530
1600 fb=point%
3000 GOTO 8000
3999 STOP
4000 ' Decode Music Data
4010 READ note$:IF note$="X" THEN RETURN
4020 IF note$="R" THEN READ dur%:note%=0:RETURN
4030 READ dur%:IF LEN(note$)=1 THEN 4100
4040 ON LEN(note$)-1 GOSUB 4200,4300,4400
4100 tone%=INSTR(tone$,note$)/2:note%=FNperiod%(tone%):RETURN
4200 l$=RIGHT$(note$,1):IF l$="#" THEN RETURN ELSE oct%=VAL(l$):note$=LEFT$(note$,1)
4210 RETURN
4300 l$=RIGHT$(note$,2):IF LEFT$(l$,1)="#" THEN oct%=VAL(RIGHT$(l$,1)):note$=LEFT$(note$,2):RETURN
4310 note$=LEFT$(note$,1):oct%=VAL(RIGHT$(l$,2)):RETURN
4400 oct%=VAL(RIGHT$(note$,2)):note$=LEFT$(note$,2):RETURN
8000 ' Try All Channels Music Driver
8010 pta=2:ptb=2:ptc=2
8020 SOUND &39,left%(1,1),left%(2,1)*3.5,0,1
8025 SOUND &3A,middle%(1,1),middle%(2,1)*3.5,0,0
8030 SOUND &3C,right%(1,1),right%(2,1)*3.5,0,1
8040 EI:EVERY 1 GOSUB 8100
8050 a$=INKEY$:IF a$="" THEN 8050 ELSE PRINT a$;:GOTO 8050
8100 ON SQ(1) GOSUB 8200
8110 ON SQ(4) GOSUB 8300
8120 ON SQ(2) GOSUB 8400
8122 IF NOT(FC=PTC AND FA=PTA AND fb=ptb) THEN RETURN
8123 SOUND &X111111,0,100,0,0:PTA=1:PTC=1:PTB=1
8130 RETURN
8190 ' Channel A
8200 DI:IF pta>=fa THEN RETURN
8205 IF LEFT%(1,pta)<>0 THEN SOUND 1,LEFT%(1,pta),left%(2,pta)*3.5,0,1 ELSE SOUND 1,LEFT%(1,pta),left%(2,pta)*3.5,0,0
8210 pta=pta+1
8220 RETURN
8290 ' Sound ON Channel C
8300 DI:IF ptc>=fc THEN RETURN
8310 IF right%(1,ptc)<>0 THEN SOUND 4,right%(1,ptc),right%(2,ptc)*3.5,0,1 ELSE SOUND 4,right%(1,ptc),right%(2,ptc)*3.5,0,0
8320 PTC=PTC+1:RETURN
8399 ' Sound ON Channel B
8400 DI:IF ptb>=fb THEN RETURN
8410 ev=1:IF middle%(1,ptb)=0 THEN ev=0
8420 SOUND 2,middle%(1,ptb),middle%(2,ptb)*3.5,0,ev:ptb=ptb+1:RETURN
9000 ' TEST MUSIC SCORE
9010 FOR I=1 TO POINTER%
9020 IF LEFT%(1,I)<>0 THEN SOUND 1,LEFT%(1,I),left%(2,i)*3.5,0,1 ELSE SOUND 1,LEFT%(1,I),left%(2,i)*3.5,0,0
9030 NEXT
10000 ' Music Data For CHANNEL A (All Envelope 1, Piano.)
10010 DATA G0,4,F,4,G,4,F,4,E,8,C,8
10020 DATA R,8,E,4,F,4,G,4,F,4,G,4,F,4
10030 DATA E,4,F,4,G,4,A,4,A#,4,A,4,A#,4,A,4
10040 DATA G,8,R,8,R,16
10050 DATA G#,8,G,8,F#,8,F,8
10060 DATA D#,4,D,4,C,4,D,4,D#,8,R,8
10065 DATA X
10066 ' Music For First Pass Around
10070 DATA D#,4,D,4,C,4,D,4,D#,8,C,8
10080 DATA G,8,R,8,F#1,1,G,7,R,8
10100 DATA X
10101 ' Music For Second Time Around
10110 DATA D#0,4,D,4,C,4,D#,4,D,4,C,4,B-1,4,D0,4
10120 DATA C,8,E,8,F,8,G,8
10130 DATA A,8,A,8,A,8,A,8
10140 DATA A,8,B,4,C1,4,B0,8,A,8
10150 DATA G,8,G,4,G,4,G,4,G,4,G,4,G,4
10160 DATA G,24,G,8
10170 DATA F,8,F,8,F,8,F,8
10180 DATA F,8,G,4,A,4,G,12,F,4
10190 'SCORE 4
10200 DATA E,32
10210 DATA C1,8,E0,8,F,8,G,8
10220 DATA G#,8,G#,8,G#,8,G#,8
10230 DATA G#,8,A#,4,C1,4,A#0,8,G#,8
10240 DATA G,8,G,4,G,4,G,4,G,4,G,4,G,4
10250 DATA G,32
10260 'SCORE 5
10270 DATA F0,8,F,8,F,8,F,8
10280 DATA D#,8,D,8,C,12,D#,4
10290 DATA G,32
10300 DATA G,16,R,16
10310 DATA G,4,F,4,G,4,F,4,E,8,C,8
10320 DATA R,8,E,4,F,4,G,4,F,4,G,4,F,4
10330 'SCORE 6
10340 DATA E,4,F,4,G,4,A,4,A#,4,A,4,A#,4,A,4
10350 DATA G,8,R,8,R,16
10360 DATA G#,8,G,8,F#,8,F,8
10370 DATA D#,4,D,4,C,4,D,4,D#,8,R,8
10380 DATA G#,8,G,8,F#,8,F,8
10390 'SCORE 7
10400 DATA D#,4,D,4,C,4,D,4,D#,16
10410 DATA G#,8,G,8,F#,8,F,8
10420 DATA D#,4,D,4,C,4,D,4,D#,16
10430 DATA D#,4,D,4,C,4,D#,4,G,8,B,8
10440 DATA C1,8,R,8,R,16
10450 DATA X
11000 ' Music Data for CHANNEL C (Right) - Bass Line
11010 ' SCORE 1
11020 'DATA C-1,8,C0,8,C-1,8,E,-1
11030 'DATA C-1,8,G,8,C,8,C0,8
11040 DATA C-1,8,R,8,C-1,8,R,8
11050 DATA C-1,8,R,8,C,8,R,8
11060 DATA C-1,8,R,8,C,8,R,8
11070 DATA C-1,8,R,8,C,8,R,8
11080 DATA G-2,8,R,8,G,8,R,8
11090 ' SCORE 2
11100 DATA C-2,8,R,8,C-1,8,R,8
11110 DATA X
11120 ' SCORE FOR FIRST PASS CHANNEL C
11130 DATA A-2,32
11140 DATA G,8,R,8,B-3,8,R,8
11150 DATA X
11160 ' SCORE FOR SECOND PASS CHANNEL C
11170 DATA A-2,8,R,8,G-2,8,R,8
11180 DATA C-1,8,R,8,C,16
11190 ' SCORE 3
11200 DATA F-1,32
11210 DATA D,16,G-2,8,R,8
11220 DATA C-1,8,G,8,G-2,8,G-1,8
11230 DATA A-2,8,E-1,8,A,8,R,8
11240 DATA D-1,8,R,8,D-2,8,R,8
11250 DATA G-2,16,G,8,R,8
11260 ' SCORE 4
11270 DATA R,8,C-1,4,G-2,4,E-1,4,C,4,G,4,E,4
11280 DATA C0,8,R,8,C-1,16
11290 DATA F,32
11300 DATA D,16,A#-2,8,R,8
11310 DATA D#-1,8,A#,8,A#-2,8,R,8
11320 DATA G,8,R,8,C-1,8,R,8
11330 ' SCORE 5
11340 DATA F-2,32
11350 DATA F#,32
11360 DATA R,8,C#-1,8,D,8,E,8
11370 DATA F,16,A-3,8,R,8
11380 DATA C-1,8,R,8,C,8,R,8
11390 DATA C,8,R,8,C,8,R,8
11400 ' SCORE 6
11410 DATA C-1,8,R,8,C,8,R,8
11420 DATA C,8,R,8,C,8,R,8
11430 DATA G-2,8,R,8,G,8,R,8
11440 DATA C,8,R,8,C-1,8,R,8
11450 DATA G-2,32
11460 ' SCORE 7
11470 DATA C-1,24,C-2,8
11480 DATA G,32
11490 DATA C-1,8,A#-2,8,A,16
11500 DATA F#,8,R,8,G,8,R,8
11510 DATA C-1,8,G-2,8,C,8,R,8
11520 DATA X
11999 DATA X
12000 ' Music Data For CHANNEL C: (Melody/Bass Lines) - Middle
12010 ' SCORE 1
12020 DATA R,8,C0,8,R,8,G-1,8
12030 DATA R,8,C0,8,R,8,E,8
12040 DATA R,8,C,8,R,8,C,8
12060 DATA R,8,C,8,R,8,C,8
12070 DATA F0,8,E,8,D#,8,D,8
12080 ' SCORE 2
12090 DATA G-1,4,R,20,C0,8
12100 DATA X
12110 ' FIRST PASS
12120 DATA F#-1,32
12130 DATA F,8,R,24
12140 DATA X
12150 ' SECOND PASS
12160 DATA F#-1,8,R,8,F,8,R,8
12170 DATA E,8,R,8,A#,16
12180 ' SCORE 3
12190 DATA R,8,C0,8,R,8,C,8
12200 DATA F,8,G,4,A,4,G,8,F,8
12210 DATA E,8,R,8,E,16
12220 DATA C#,24,R,8
12230 DATA R,8,A-1,8,R,8,A,8
12240 DATA B-1,16,R,8,B,8
12250 ' SCORE 4
12260 DATA C0,32
12270 DATA E,8,E,8,D,8,E,8
12280 DATA R,8,F,8,R,8,F,8
12290 DATA F,8,G,4,G#,4,G,8,F,8
12300 DATA D#,16,D,16
12310 DATA R,8,A#-1,8,R,8,A#-1,8
12320 ' SCORE 5
12330 DATA R,8,C0,8,R,8,C0,8
12340 DATA A-1,24,A,8
12350 DATA R,8,A#,8,B,8,C#0,8
12360 DATA D0,16,R,16
12370 DATA R,8,C,8,R,8,C,8
12380 DATA R,8,C,8,R,8,C,8
12390 ' SCORE 6
12400 DATA R,8,C,8,R,8,C,8
12410 DATA R,8,C,8,R,8,C,8
12420 DATA F,8,E,8,D#,8,D,8
12430 DATA G-1,8,R,16,G,8
12440 DATA B,32
12450 ' SCORE 7
12460 DATA G-1,24,R,8
12470 DATA F,32
12480 DATA G,16,G,16
12490 DATA C,8,R,8,F,8,R,8
12500 DATA E,8,R,24
13000 DATA X
