10 REM COMPUTERIZED CHRISTMAS CARD
20 REM BY RACHEL BRAVERMAN & JON TARRANT
25 :
30 REM DEFINE PROGRAM PARAMETERS
40 DEFSTR a:DEFINT b-y:DEFREAL z
50 n=30:jump=-8:base=20:top=410:wide=640-20:height=400-base:ea=300:eb=276:tx=20*16-2:ty=400-(11*16):sx=-4*16:sy=-4*16:rx=2*16:ry=0:bx=0:by=-2*16:a1=CHR$(238):a2=CHR$(202)
60 DEF FNzy(zx)=(eb*eb)*(1-((zx*zx)/(ea*ea)))
70 DIM p(n,1)
80 :
90 REM set up graphics required
100 MODE 1
110 INK 0,0:INK 1,0:INK 2,18:INK 3,6:BORDER 1
120 PRINT CHR$(22)+CHR$(1);
130 ORIGIN 318,0:TAG
240 :
250 REM initialize screen display
260 FOR s=0 TO n
270 x=INT(RND(1)*(wide+1))-318:zx=ABS(x):y=INT(RND(1)*(height+1))+base
280 IF (y*y)<FNzy(zx) THEN s=s-1:ELSE PLOT x,y,1:PRINT"*";:p(s,0)=x:p(s,1)=y
290 NEXT s
300 INK 1,26
310 :
320 REM draw christmas tree
330 ORIGIN 0,0
340 PLOT 19.5*16-2,400-10.25*16,1:PRINT a1;
350 FOR dv=16 TO 24 STEP 4
360 PLOT (15.5-((dv-16)/2))*16-2,400-(dv-1)*16,3:PRINT a2;
370 PLOT (23.5+((dv-16)/2))*16,400-(dv-1)*16,3:PRINT a2;
380 NEXT dv
390 FOR dv=-1 TO 1 STEP 2
400 PLOT tx,ty,2
410 FOR seg=1 TO 3 STEP 1
420 DRAWR sx*dv,sy:DRAWR rx*dv,ry
430 NEXT seg
440 DRAWR 2.25*rx*dv,dy:DRAWR bx,by
450 NEXT dv
460 PLOT 19*16,400-(14*16),1:PRINT"WE";
470 PLOT 18*16,400-(15.5*16),1:PRINT"WISH";
480 PLOT 17.5*16,400-(17*16),1:PRINT"YOU A";
490 PLOT 17.5*16,400-(19.5*16),3:PRINT"MERRY";
500 PLOT 15.5*16,400-(21.5*16),3:PRINT"CHRISTMAS";
510 ORIGIN 318,0
520 :
530 REM main program loop
540 progrunning=1
550 WHILE progrunning
560 RESTORE 800
570 f1=1
580 WHILE f1<>0
590 READ f1,f2,f3,f4,f5,f6,f7,f8,f9
600 SOUND f1,f2,f3*1.2
601 SOUND f4,f5,f6*1.2
602 SOUND f7,f8,f9*1.2
610 GOSUB 690
620 WEND
630 FOR d=0 TO 1200 STEP 1
640 REM delay loop
650 NEXT d
660 WEND
670 STOP
680 :
690 REM routine to move snowflakes
700 s=INT(RND(1)*(n+1)):x=p(s,0):y=p(s,1):ym=jump:xm=INT(RND(1)*5)-2
710 IF (x<(-0.5*ea)-2 OR x>(0.5*ea)+2) THEN bottom=base ELSE bottom=SQR(FNzy(x))
720 PLOT x,y,0:PRINT"*";
730 LET x=x+xm:LET y=y+ym
740 PLOT x,y,1:PRINT"*";
750 IF y<bottom THEN PLOT x,y,0:PRINT"*";:y=top
760 p(s,0)=x:p(s,1)=y
770 RETURN
780 :
790 REM data statements holding music
800 DATA 49,0,1,42,0,1,28,0,1,1,358,30,1,268,30,1,0,1,1,268,15,1,239,15,1,268,15,1,284,15,1,319,30,1,0,1,1,319,30,1,0,1,1,319,30,1,239,30,1,0,1,1,239,15,1,213,15,1,239,15,1,268,15,1,284,30,1,358,30,1,0,1
810 DATA 1,358,30,1,213,30,1,0,1,1,213,15,1,201,15,1,213,15,1,239,15,1,268,30,1,319,30,1,358,15,1,0,1,1,358,15,1,319,30,1,239,30,1,284,30,1,268,60,17,358,30,10,358,15,2,402,15
820 DATA 17,268,30,10,426,15,1,0,1,2,478,15,17,268,30,10,536,15,2,478,15,49,236,30,42,426,15,1,0,1,28,1073,30,2,379,15,49,284,60,42,358,60,28,716,30,4,0,1,4,716,30,49,284,30,42,338,30,28,851,30
830 DATA 49,268,30,42,319,30,28,638,30,49,284,30,42,358,30,28,478,30,4,0,1,49,319,30,42,379,30,28,478,15,4,536,15,49,358,60,42,568,60,28,716,60,49,239,30,42,358,30,28,568,30,2,0,1,49,213,30,42,358,30,28,536,30,2,0,1
840 DATA 49,239,15,42,358,15,28,568,15,49,0,1,42,0,1,28,0,1,49,239,15,42,358,15,28,568,15,49,268,15,42,379,15,28,638,15,49,0,1,42,0,1,28,0,1,49,268,15,42,379,15,28,638,15,49,179,30,42,284,15,28,716,30,2,319,15
850 DATA 4,0,1,49,358,30,42,358,30,28,716,15,4,804,15,49,358,15,42,358,15,28,851,15,49,0,1,42,0,1,28,0,1,49,358,15,42,358,15,28,851,15,49,319,30,42,402,30,28,804,15,4,851,15,49,239,30,42,319,15,28,956,30,2,358,15
860 DATA 2,0,1,49,284,30,42,358,30,28,716,30,49,268,60,42,358,60,28,536,60
870 DATA 2,358,30,2,268,30,2,0,1,2,268,15,2,239,15,34,268,15,20,536,30,2,284,15,34,319,30,20,402,30,34,0,1,20,0,1,34,319,30,20,402,15,4,358,15,2,0,1,34,319,30,20,402,15,4,426,15,34,239,30,20,478,30,34,0,1,20,0,1
880 DATA 34,239,15,20,478,30,2,213,15,34,239,15,20,379,30,2,268,15,34,284,30,20,358,30,4,0,1,34,358,30,20,358,15,4,319,15,34,358,30,20,358,15,4,402,15,34,213,30,20,426,15,4,379,15,2,0,1,34,213,15,20,338,30
890 DATA 2,201,15,34,213,15,20,426,30,2,239,15,34,268,30,20,319,45,2,319,30,4,358,15,34,358,30,20,402,15,4,426,15,34,319,30,20,402,15,4,426,15,34,239,30,20,478,30,34,284,30,20,358,30,34,268,60,20,536,60
900 DATA 49,358,30,42,478,30,28,402,30,49,268,30,42,358,15,28,426,15,34,402,15,20,478,15,1,0,1,49,268,30,42,426,15,28,536,15,34,402,15,20,478,15,1,0,1,49,268,30,42,358,15,28,426,15,34,638,15,20,402,15
910 DATA 49,284,60,42,478,60,28,358,15,4,319,15,4,358,15,4,402,15,17,0,1,10,0,1,49,284,30,42,478,30,28,426,15,4,478,15,49,268,30,42,358,30,28,426,30,49,284,30,42,478,15,28,478,30,2,451,15,49,319,30,42,379,30
920 DATA 28,478,15,4,536,15,49,358,60,42,478,30,28,568,30,34,536,30,20,638,30
930 DATA 49,239,30,42,358,30,28,568,30,2,0,1,49,213,30,42,358,30,28,536,30,49,239,15,42,358,15,28,568,15,49,0,1,42,0,1,28,0,1,49,239,15,42,358,15,28,568,15,49,268,15,42,402,15,28,638,15,49,0,1,42,0,1,28,0,1
940 DATA 49,268,15,42,402,15,28,638,15,49,179,30,42,284,15,28,716,30,2,319,15,4,0,1,49,358,30,42,358,30,28,716,15,4,804,15,1,0,1,49,358,15,42,536,15,28,851,15,49,0,1,42,0,1,28,0,1,49,358,15,42,536,15,28,851,15
950 DATA 49,319,30,42,402,30,28,804,30,49,239,30,42,319,30,28,956,30,49,284,30,42,358,30,28,716,30,2,0,1,49,268,90,42,358,90,28,1073,90
960 DATA 128,0,1,0,0,0,0,0,0,0,0,0
970 DATA end
980 END
