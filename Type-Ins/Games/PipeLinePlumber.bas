10 ' Pipe line plumber
20 ' By K. Freeman and typed in by J.Brooks 1987
30 MODE 0
40 DEFINT a-z
50 SYMBOL AFTER 256:MEMORY &8FFF
60 SYMBOL AFTER 32
70 GOSUB 2730
110 MOVE 500,20:DRAWR 30,10
120 MOVE 500,20:DRAWR 30,-5
130 MOVE 514,7:DRAWR 0,25
140 PEN 8:LOCATE 6,10:PRINT"Pipeline"
150 LOCATE 8,12:PRINT"Plumber
160 GOSUB 2580
170 DIM grid(20,12),start(20,12)
180 'Position of Disrupter
190 RESTORE 200:FOR t=1 TO 6:READ n,m:dx(t)=n:dy(t)=m:NEXT
200 DATA 17,7,14,3,15,11,10,5,6,4,14,5
210 FOR t=200 TO 60 STEP -1:SOUND 4,t,1,9:NEXT
220 ' Default control keys
230 up=0:dw=2:lf=8:rt=1:hv=47
240 GOSUB 680
250 scr=1:sc=0
260 SOUND 2,2000,7,13:MODE 0
270 BORDER 0
280 IF scr=1 THEN RESTORE 1790
290 IF scr=2 THEN RESTORE 1920
300 IF scr=3 THEN RESTORE 2050
310 IF scr=4 THEN RESTORE 2180
320 IF scr=5 THEN RESTORE 2310
330 IF scr=6 THEN RESTORE 2440
340 'Show Screen
350 l=0:q=0
360 FOR y=1 TO 12
370 READ n$
380 FOR x=1 TO 20
390 s=(ASC(MID$(n$,x,1)))-97
400 |SPRITE,(x-1)*2,(y-1)*2,s
410 grid(x,y)=s:start(x,y)=s
420 NEXT x
430 NEXT y
440 FOR t=1 TO 1000:SOUND 1,t,1,9:SOUND 2,1000-t,1,9:NEXT
450 'Time left box
460 PLOT 370,0,2:DRAW 639,0
470 PLOT 370,10:DRAW 639,10
480 GOSUB 1580
490 GOSUB 1520
500 'Variables
510 x=2:y=11:o=y:a=x:b=y
520 dx=dx(scr):dy=dy(scr):GOSUB 1130:da=dx:db=dy
530 grid(dx,dy)=17
540 w=370:hold=0
550 'keypress
560 IF INKEY(rt)=0 AND x<19 THEN px=1:py=0:s=11:GOTO 850
570 IF INKEY(lf)=0 AND x>1 THEN px=-1:py=0:s=12:GOTO 850
580 IF INKEY(up)=0 AND y>1 THEN px=0:py=-1:s=9:GOTO 850
590 IF INKEY(dw)=0 AND y<11 THEN px=0:py=1:s=10:GOTO 850
600 IF INKEY(71)=0 AND hold=1 THEN SOUND 2,1000,2,,,5:GOSUB 1240
610 IF INKEY(63)=0 AND hold=0 THEN SOUND 2,1500,3,,,8:GOSUB 1400
620 GOSUB 960
630 v=v+1:IF v=55 THEN GOSUB 1540
640 IF q=l THEN 780
650 IF w<639 THEN 560 ELSE GOSUB 660:GOTO 260
660 FOR t=2000 TO 1000 STEP -10:SOUND 1,t,1,7:NEXT:MODE 0
670 LOCATE 5,12:PEN 1:PRINT"Game over";
680 LOCATE 5,17:PEN 10:PRINT"P to play";
690 PEN 7
700 LOCATE 5,18:PRINT"C set Controls"
710 IF sc>h THEN h=sc
720 LOCATE 10,21:PEN 6:PRINT"Hi=";h
730 scr=1:sc=0
740 IF INKEY(27)=0 THEN RETURN
750 IF INKEY(62)=0 THEN GOSUB 3780
760 IF INKEY(46)=0 THEN END
770 GOTO 740
780 FOR t=60 TO 200:SOUND 4,t,1,10:NEXT
790 sc=sc+640-w:GOSUB 1520
800 scr=scr+1:IF scr<7 THEN 260
810 MODE 0
820 LOCATE 3,12:PEN 1:PRINT"Game completed";
830 GOSUB 680:GOTO 260
840 'Move/Hover
850 SOUND 4,s^2,5,5,,,1
860 GOSUB 960
870 IF INKEY(hv)=0 THEN IF s<>o GOTO 900 ELSE 630
880 IF grid(x+px,y+py)>16 THEN x=x+px:y=y+py
890 IF a=x AND b=y AND o=s THEN 560
900 |SPRITE,(a-1)*2,(b-1)*2,o
910 |SPRITE,(x-1)*2,(y-1)*2,s
920 a=x:b=y:o=s
930 IF x=dx AND y=dy THEN GOSUB 1060
940 GOTO 630
950 'move disruptor
960 mv=mv+1:IF mv<3 THEN RETURN ELSE mv=0
970 gr=grid(dx+du,dy+dn)
980 SOUND 1,300,5,5:SOUND 4,200,3,3
990 IF gr<16 THEN 1130 ELSE dx=dx+du:dy=dy+dn
1000 |SPRITE,(da-1)*2,(db-1)*2,14
1010 |SPRITE,(dx-1)*2,(dy-1)*2,14
1020 da=dx:db=dy
1030 IF dx=x AND dy=y THEN 1060
1040 RETURN
1050 'Disruptor contact
1060 FOR wt=100 TO 120:SOUND 4,wt,2,wt/10:BORDER wt/5-10:NEXT
1070 |SPRITE,(a-1)*2,(b-1)*2,o
1080 x=2:y=11:o=11:a=x:b=y
1090 |SPRITE,(x-1)*2,(y-1)*2,o
1100 BORDER 0
1110 RETURN
1120 END
1130 r=RND*7+1
1140 ON r GOTO 1150,1160,1170,1180,1190,1200,1210,1220
1150 du=-1:dn=0:RETURN
1160 du=-1:dn=-1:RETURN
1170 du=1:dn=-1:RETURN
1180 du=1:dn=1:RETURN
1190 du=0:dn=-1:RETURN
1200 du=1:dn=0:RETURN
1210 du=-1:dn=1:RETURN
1220 du=0:dn=1:RETURN
1230 'Drop pipe
1240 d=grid(x+px,y+py)
1250 IF d<17 THEN RETURN
1260 grid(x+px,y+py)=p
1270 hold=0
1280 IF start(x+px,y+py)<>p THEN 1360
1290 BORDER 6:INK 0,6
1300 FOR wt=1 TO 50:NEXT
1310 SOUND 1,1000,5,14
1320 BORDER 0:INK 0,0
1330 q=q+1:GOSUB 1500
1340 sc=sc+1:GOSUB 1520
1350 'Display/erase pipe
1360 |SPRITE,(x+px-1)*2,(y+py-1)*2,p
1370 |SPRITE,38,22,p
1380 RETURN
1390 'pick up pipe
1400 p=grid(x+px,y+py)
1410 IF p>5 THEN RETURN
1420 grid(x+px,y+py)=17
1430 hold=1
1440 IF start(x+px,y+py)<>p THEN 1360
1450 SOUND 1,3000,5,14
1460 q=q-1:GOSUB 1500
1470 sc=sc-1:GOSUB 1520
1480 GOTO 1360:' Jump to erase/display pipe
1490 'no. connected
1500 LOCATE 9,25:PEN 7:PRINT q;
1510 RETURN
1520 LOCATE 1,25:PEN 3:PRINT sc;
1530 RETURN
1540 w=w+3:v=0
1550 MOVE w,2:DRAW w,9,12
1560 RETURN
1570 'move pipeline
1580 FOR y=1 TO 12
1590 FOR x=1 TO 20
1600 IF start(x,y)<6 THEN GOSUB 1650
1610 NEXT x
1620 NEXT y
1630 GOSUB 1500
1640 RETURN
1650 p=grid(x,y)
1660 grid(x,y)=17
1670 l=l+1
1680 |SPRITE,(x-1)*2,(y-1)*2,p
1690 a=RND*19+1:b=RND*11+1
1700 IF grid(a,b)<>17 THEN 1690
1710 IF start(a,b)=p THEN 1690
1720 grid(a,b)=p
1730 |SPRITE,(a-1)*2,(b-1)*2,p
1740 SOUND 2,500,2,6
1750 LOCATE 6,25:PEN 10:PRINT l;
1760 RETURN
1770 'data for screens
1780 'screen 1
1790 DATA hhiiiihsssssssshhihh
1800 DATA hrrrrrhhiiiisiihrrih
1810 DATA iibddfrrrrhiihrrrrri
1820 DATA inahharrrrhhhrrrbgri
1830 DATA iechharhrrhrrrrrarri
1840 DATA irrrharhrrrrbdddcrri
1850 DATA irrrrarhhrrrarrrorri
1860 DATA irrrrarhhhrrahhrrrri
1870 DATA irrrreddddddchrrrrih
1880 DATA hsirrrrrrrrhhhhrrrih
1890 DATA jljrrrrrrrrrrrrrrhss
1900 DATA hhhhiiiiiiiiiiiihhss
1910 'Screen 2
1920 DATA iinhhssshhiiiiiissss
1930 DATA irarrhshrrrrhirhhhhh
1940 DATA hrefriiiirrhrorirrrh
1950 DATA hhrarhhrrrhrrrrirrri
1960 DATA sirarhrbddddfirhbdgi
1970 DATA sirarhrarhhraihharri
1980 DATA hiredddcrhrrairrarii
1990 DATA irrrrhrrrrrraihbciii
2000 DATA irrrhhrrrrrrabdcrrri
2010 DATA ishhhrrriiiraahhrhii
2020 DATA ilhrrrriisirecrrriss
2030 DATA iiiiiiiissiiiiiiiiss
2040 'Screen 3
2050 DATA ssiiiiiissiiiiiihhhh
2060 DATA sshhrrrissirrhhrrrrh
2070 DATA ihhrrrrnisirbddddfri
2080 DATA irrrbddcishrahhhrahi
2090 DATA irrhahhhihhrahhrrari
2100 DATA ihhredddddddcbdddcri
2110 DATA irrrrrrrrrhrrarrhhri
2120 DATA irrrrbfrrrhrrarrhrri
2130 DATA irrrhaeddddddcrrhrri
2140 DATA hshrhegrrhrhrrrrhiii
2150 DATA hlhrhhrrrhihrrorhiss
2160 DATA hhhhiiiiiiiiiiihhiss
2170 'screen 4
2180 DATA sssshhiiiiiiinihiihh
2190 DATA sssshrbdddfhharhrrrh
2200 DATA ssssirarrrahrarhhhri
2210 DATA ssiirrahhreddcrrrhri
2220 DATA sshhhbcrhorbddfrrrri
2230 DATA ssihhefhhrrefrarrhri
2240 DATA hiirrrahbfrrarahhrri
2250 DATA irrrhhahaahrabchhrri
2260 DATA irrrhharaahhaegrhrri
2270 DATA ishiiredceddcrrrriii
2280 DATA ilhhirrrrhhhrrrrhiss
2290 DATA ihniiiiiiiiiihhhiiss
2300 'Screen 5
2310 DATA siiiiihhhhiiiihiihhs
2320 DATA ihhhrrrhrbddfrhrrrhs
2330 DATA irhbddfhharrahirhris
2340 DATA irbcroanhahreddfiiih
2350 DATA ihefrraahahrrhrarrhi
2360 DATA siharraedchrrhrefrri
2370 DATA ssharrarhhhhrrhhahri
2380 DATA hhhegrefhrrhrrrbcrrh
2390 DATA irrrrrredfrhrrrahhhh
2400 DATA ishrrrrhhedddddchhii
2410 DATA ilhrrrrrrrrrrrrrrhss
2420 DATA iihhiiiiiiiiiiiihhss
2430 'Screen 6
2440 DATA iiiiihhiiiiiiihnhiih
2450 DATA ihhrrriirirrrrheddfh
2460 DATA hnhrrrirrrrbddddddch
2470 DATA iarrrrhrhrrarrhriihh
2480 DATA iarrhhhhhrrarohrisss
2490 DATA iedddfbdddfarrhhhsss
2500 DATA irhhhaegrhecrrrrhiii
2510 DATA irhrrarrrhhhrrrrrrri
2520 DATA irhireddddddddfrrrri
2530 DATA hshirrrrrhhrrregriii
2540 DATA hlhihhhrrrrrrrrrrhss
2550 DATA hhhsssiiiiiiiiiihhss
2560 ' Poke codes into memory
2570 ' @ &9000-&9480
2580 RESTORE 2790:mem=&9000
2590 BORDER 0
2600 FOR dl=1 TO 96:READ d$,ck:rs=0
2610 FOR by=1 TO 24 STEP 2
2620 a=VAL("&"+MID$(d$,by,2))
2630 rs=rs+a
2640 POKE mem,a
2650 mem=mem+1
2660 NEXT by:IF rs<>ck THEN 2750
2670 SOUND 4,300,3,10
2680 IF ab=12 THEN ab=11 ELSE ab=12
2690 DRAWR 0,0,ab:MOVE dl*6,332:DRAWR -8,18
2700 NEXT dl:CALL &9000
2710 RETURN
2720 'Set pens
2730 RESTORE 3760
2740 FOR t=0 TO 15:READ k:INK t,k:NEXT:RETURN
2750 SOUND 4,600,6,15:BORDER 6
2760 MODE 1:INK 0,1:INK 1,26
2770 PRINT"ÄŽ1Data error in line..";dl*10+2780 
2780 END
2790 DATA 010e90210a90cdd1bcc90a90,1303
2800 DATA 0e901390c31a905350524954,1088
2810 DATA c500dd4602dd4e04dd7e00fe,1394
2820 DATA 10d0076f2600117090197e5f,899
2830 DATA 237efeffc85778fe19d0d504,1781
2840 DATA 11500021b0bf1910fdd179fe,1375
2850 DATA 28d007d55f160019d11a4713,935
2860 DATA 1a4f13c5e51aae77231310f9,1188
2870 DATA e10100080930040150c009c1,770
2880 DATA 0d20e8c99090d29014915691,1516
2890 DATA 9891da911c925e92a092e292,1752
2900 DATA 24936693a893ea933894ffff,1842
2910 DATA 041000736f0000736f000073,587
2920 DATA 6f0000736f0000736f000073,678
2930 DATA 6f0000736f0000736f000073,678
2940 DATA 6f0000736f0000736f000073,678
2950 DATA 6f0000736f0000736f000073,678
2960 DATA 6f0000736f00041000000000,357
2970 DATA 000000000000000000000000,0
2980 DATA 00113333003333330073f3f3,873
2990 DATA 0073f3f300733f3f00733f3f,1083
3000 DATA 00736fcf00736fcf00736f00,1092
3010 DATA 00736f0000736f0000736f00,678
3020 DATA 041000736f0000736f000073,587
3030 DATA 6f0000736f0033736f003373,780
3040 DATA 6f00f3f36f00f3f36f003f3f,1431
3050 DATA 6f003f3f6f00cfcfcf00cfcf,1383
3060 DATA 8a0000000000000000000000,138
3070 DATA 000000000000041000000000,20
3080 DATA 000000000000000000000000,0
3090 DATA 3333333333333333f3f3f3f3,1380
3100 DATA f3f3f3f33f3f3f3f3f3f3f3f,1476
3110 DATA cfcfcfcfcfcfcfcf00000000,1656
3120 DATA 000000000000000000000000,0
3130 DATA 041000736f0000736f000073,587
3140 DATA 6f0000736f0000736fcf0073,885
3150 DATA 6fcf00733f3f00733f3f0073,915
3160 DATA f3f30073f3f3003333330033,1291
3170 DATA 333300000000000000000000,102
3180 DATA 000000000000041000000000,20
3190 DATA 000000000000000000000000,0
3200 DATA 3333330033333300f3f3b300,971
3210 DATA f3f3b3003f3fb3003f3fb300,1275
3220 DATA cf9fb300cf9fb300009fb300,1428
3230 DATA 009fb300009fb300009fb300,1014
3240 DATA 04100051aacf0055e7db0055,1098
3250 DATA 22a200005500220077003345,554
3260 DATA e7aab3153322f3739ba23f73,1539
3270 DATA 9ba26fb39ba2cf339ba29b67,1757
3280 DATA cf73459b4573453345db0022,1172
3290 DATA 45cf000051cf0410030f1e3c,692
3300 DATA 030f1e3c57ffffbe570f1ebe,1217
3310 DATA 570f1ebe57ffffbe030f1e3c,1217
3320 DATA 57ffffbe030f1e3c57ffffbe,1682
3330 DATA 570f1ebe570f1ebe57ffffbe,1431
3340 DATA 030f1e3c57ffffbe030f1e3c,1003
3350 DATA 0410ccd0d0ffccd0d0ff9c3c,1986
3360 DATA 3c7d9cd0d07d9cd0d07d9c3c,1795
3370 DATA 3c7dccd0d0f5ccd0d0f59c3c,2131
3380 DATA 3c7dccd0d0f5ccd0d0f59c3c,2131
3390 DATA 3c7d9cd0d07d9cd0d07d9c3c,1795
3400 DATA 3c7dccd0d0ff041000281400,1140
3410 DATA 002814000002010000020100,66
3420 DATA 00f4780000f4780045fcbc8a,1375
3430 DATA 45fcbc8a453c3c8a453c3c8a,1301
3440 DATA 459e6d8a459e6d8a00458a00,1155
3450 DATA 00458a000000000000000000,207
3460 DATA 041000000000000000000045,89
3470 DATA 8a0000458a00459e6d8a459e,1046
3480 DATA 6d8a453c3c8a453c3c8a45fc,1222
3490 DATA bc8a45fcbc8a00f4780000f4,1581
3500 DATA 780000020100000201000028,166
3510 DATA 140000281400041000000000,100
3520 DATA 0000000000cf8a0000cf8a00,690
3530 DATA 009ef816009ef816453cfc00,1237
3540 DATA 453cfc00453cbc00453cbc00,1015
3550 DATA 009e7816009e781600cf8a00,945
3560 DATA 00cf8a000000000000000000,345
3570 DATA 041000000000000000000045,89
3580 DATA cf000045cf0029f46d0029f4,1162
3590 DATA 6d0000fc3c8a00fc3c8a007c,1133
3600 DATA 3c8a007c3c8a29b46d0029b4,1071
3610 DATA 6d000045cf000045cf000000,661
3620 DATA 0000000000000410c3c3c3c3,800
3630 DATA c3c3c3c312736f8112736f81,1526
3640 DATA c3ffafc312736f8112736f81,1566
3650 DATA c3ffafc312736f8112736f81,1566
3660 DATA c3ffafc312736f8112736f81,1566
3670 DATA 12736f8147736f8b47736f8b,1245
3680 DATA 000000000000000000000000,0
3690 DATA 04100000000015373f2a0000,201
3700 DATA 0000003f372a000000000000,160
3710 DATA 2a00003b3f00003b3f00003b,345
3720 DATA 3f000000000000002a000011,122
3730 DATA 3f0000113f0000002a001537,261
3740 DATA 3f3f00152a00081800000000,221
3750 'Pen Colour
3760 DATA 0,24,19,21,25,9,6,15,16
3770 DATA 8,7,2,11,23,26,10
3780 'Select Keyboard/Joystick
3790 PEN 1:MODE 1
3800 LOCATE 5,1:PRINT"Control"
3810 PEN 2:LOCATE 5,5:PRINT"J Joystick"
3820 PEN 3:LOCATE 5,7:PRINT"K Keyboard"
3830 PEN 1
3840 IF INKEY(37)=0 THEN 3870
3850 IF INKEY(45)=0 THEN 3940
3860 GOTO 3840
3870 rt=1:rt$="Cursor Right"
3880 lf=8:lf$="Cursor Left"
3890 up=0:up$="Cursor Up"
3900 dw=2:dw$="Cursor Down"
3910 hv=47:hv$="Space Bar"
3920 LOCATE 5,5:PRINT SPC(10);
3930 GOTO 4000
3940 rt=75:rt$="Joystick Right"
3950 lf=74:lf$="Joystick Left"
3960 up=72:up$="Joystick Up"
3970 dw=73:dw$="Joystick Down"
3980 hv=76:hv$="Fire"
3990 LOCATE 5,7:PRINT SPC(10);
4000 LOCATE 5,10:PRINT"Right    ";rt$
4010 LOCATE 5,12:PRINT"Left     ";lf$
4020 LOCATE 5,14:PRINT"Up       ";up$
4030 LOCATE 5,16:PRINT"Down     ";dw$
4040 LOCATE 5,18:PRINT"Hover    ";hv$
4050 PEN 2
4060 LOCATE 5,20:PRINT"Pick-up    X"
4070 LOCATE 5,22:PRINT"Drop       Z"
4080 PEN 3:LOCATE 10,24:PRINT"P to play";
4090 RETURN
