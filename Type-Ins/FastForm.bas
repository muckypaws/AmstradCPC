10 qw=0
20 IF PEEK(&3130)<>&ED THEN OPENOUT"Y":MEMORY &2DFF:LOAD"format.bin",&2E00:LOAD"ksaver.bin",&7000  
30 CLOSEOUT
40 CALL &2E00
50 MODE 2:WINDOW #1,1,79,1,3:PRINT#1,"Fast Formatter V1.7  -  $ RpM 1986"
60 WINDOW #0,1,80,4,25        
70 PRINT"Format Type:":PRINT:PRINT"1 - CPM (System)":PRINT"2 - CPM (Vendor)":PRINT"3 - DATA":PRINT"4 - IBM":PRINT"5 - BIGK (206k)"
80 q$=INKEY$:IF q$="" THEN 80
90 ON INSTR("12345",q$) GOTO 170,250,310,360,410
100 SOUND 7,1000,10,7:GOTO 80
110 CLS: IF PEEK(&B4A0)<>1 THEN PRINT"DRIVE (A/B) ?" ELSE Art$="A":GOTO 160
120 a$=INKEY$:IF a$="" THEN 120   
130 IF a$="a" OR a$="A" THEN drive=0:art$="A":dr=0:GOTO 160
140 IF a$="b" OR a$="B" THEN drive=1:art$="B":dr=&40:GOTO 160 
150 GOTO 120
160 :IF q=1 THEN RETURN ELSE CLS:PRINT"Insert Disc In Drive ";art$;" And Press Any Key!":CALL &BB18:|DRIVE,@art$:RETURN 
170 q=1: GOSUB 110:q=0
180 IF drive=0 THEN POKE &3022,0:POKE &302A,0:POKE &319E,&DA ELSE POKE &3022,1:POKE &302A,1:POKE &319E,&DD  
190 POKE &3020,&41:POKE &30F3+3,&41:POKE &30F7+3,&46:POKE &30FB+3,&42:POKE &30FF+3,&47:POKE &3103+3,&43:POKE &3107+3,&48:POKE &310B+
3,&44:POKE &310F+3,&49:POKE &3113+3,&45
200 POKE &308F,&F4:POKE &3090,&30:POKE &3099,&F4:POKE &309A,&30 
210 CLS:PRINT"Insert A CPM (System) Disc Into Drive ";art$;" And Press Any Key!"
220 CALL &BB18:POKE &2F43,&A9:POKE &2F44,&2F:POKE &2F26,&A9:POKE &2F27,&2F:POKE &2F1D,DRIVE:POKE &2F3A,DRIVE :CALL &2F00:CALL &2F17:
CLS:PRINT"Insert Disc Into Drive ";art$;" For Formatting And Press Any Key!":CALL &BB18
230 CLS: PRINT"Drive ";art$;":":PRINT"CPM (System) Format":PRINT"Formatting Track  ";:CALL &3000:POKE &2F43,&AD:POKE &2F44,&2F:POKE 
&2F26,&AD:POKE &2F27,&2F:POKE &2F1D,DRIVE:POKE &2F3A,DRIVE
240 CALL &2F17:GOTO 510 
250 GOSUB 110 
260 IF drive=0 THEN POKE &3022,0:POKE &302A,0:POKE &319E,&DA ELSE POKE &3022,1:POKE &302A,1:POKE &319E,&DD  
270 POKE &3020,&41:POKE &30F3+3,&41:POKE &30F7+3,&46:POKE &30FB+3,&42:POKE &30FF+3,&47:POKE &3103+3,&43:POKE &3107+3,&48:POKE &310B+
3,&44:POKE &310F+3,&49:POKE &3113+3,&45
280 POKE &308F,&F4:POKE &3090,&30:POKE &3099,&F4:POKE &309A,&30 
290 CLS: PRINT"Drive ";art$;":":PRINT"CPM (Vendor) Format":PRINT"Formatting Track  ";:CALL &3000 
300 GOTO 510
310 GOSUB 110
320 IF drive=0 THEN POKE &3022,0:POKE &302A,0:POKE &319E,&DA ELSE POKE &3022,1:POKE &302A,1:POKE &319E,&DD
330 POKE &3020,&C1:POKE &30F3+3,&C1:POKE &30F7+3,&C6:POKE &30FB+3,&C2:POKE &30FF+3,&C7:POKE &3103+3,&C3:POKE &3107+3,&C8:POKE &310B+
3,&C4:POKE &310F+3,&C9:POKE &3113+3,&C5 
340 POKE &308F,&F4:POKE &3090,&30:POKE &3099,&F4:POKE &309A,&30
350 CLS: PRINT"Drive ";art$;":":PRINT"DATA Format": PRINT"Formatting Track  ";:CALL &3000:GOTO 510
360 GOSUB 110 
370 IF drive=0 THEN POKE &3022,0:POKE &302A,0:POKE &319E,&DA ELSE POKE &3022,1:POKE &302A,1:POKE &319E,&DD 
380 POKE &3020,&1:POKE &30F3+3,&1:POKE &30F7+3,&2:POKE &30FB+3,3:POKE &30FF+3,&4:POKE &3103+3,&5:POKE &3107+3,&6:POKE &310B+3,&7:POK
E &310F+3,&8:POKE &3113+3,&9
390 POKE &308F,&F4:POKE &3090,&30:POKE &3099,&F4:POKE &309A,&30 
400 CLS: PRINT"Drive ";art$;":":PRINT"IBM Format":PRINT"Formatting Track  ";:CALL &3000:GOTO 510
410 GOSUB 110:POKE &A8A8+dr,&FF:POKE &A890+dr,&28:POKE &A895+dr,&D0:POKE &A89D+dr,1:POKE &A89F+dr,&30:POKE &A8A0+dr,&A:POKE &A8A2+dr
,&32:POKE &A8A3+dr,&E5:POKE &A8A1+dr,&20
420 :POKE &308F,&A5:POKE &3090,&31:POKE &3099,&A5:POKE &309A,&31: 
430 IF drive=0 THEN POKE &314C,0: POKE &319E,&DA ELSE POKE &314C,1:POKE &319E,&DD
440 CLS: PRINT"Drive ";art$;":":PRINT"BIGK Format":PRINT"Formatting Track  ";:CALL &3130 
450 IF drive=0 THEN POKE &3022,0:POKE &302A,0:POKE &319E,&DA ELSE POKE &3022,1:POKE &302A,1:POKE &319E,&DD:
460 POKE &3020,&C1:POKE &30F3+3,&C1:POKE &30F7+3,&C6:POKE &30FB+3,&C2:POKE &30FF+3,&C7:POKE &3103+3,&C3:POKE &3107+3,&C8:POKE &310B+
3,&C4:POKE &310F+3,&C9:POKE &3113+3,&C5 :POKE &308F,&F4:POKE &3090,&30:POKE &3099,&F4:POKE &309A,&30:
470 CALL &7175
480 POKE &301A,&1:PRINT"Formatting Track  ";:CALL &3000:CALL &7150
490 FOR t=&A890 TO &A890+24:POKE t,0:NEXT:
500 FOR t=&A890+&40 TO &A890+&40+24:POKE t,0:NEXT
510 :PRINT:PRINT:PRINT"1 -- Format Disc"  
520 PRINT"2 -- Leave Program"
530 a$=INKEY$:IF a$="" THEN 530
540 IF a$="1" THEN RUN 10
550 IF a$="2" THEN PRINT:PRINT:PRINT"bye bye":FOR t=0 TO 50:NEXT:|BASIC
560 GOTO 530
